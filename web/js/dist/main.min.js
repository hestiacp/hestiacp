(()=>{function g(){return{initialized:!1,open:!1,notifications:[],toggle(){this.open=!this.open,this.initialized||this.list()},async list(){let t=document.querySelector("#token").getAttribute("token"),e=await fetch(`/list/notifications/?ajax=1&token=${t}`);if(this.initialized=!0,!e.ok)throw new Error("An error occurred while listing notifications.");this.notifications=Object.entries(await e.json()).reduce((n,[i,r])=>[...n,r],[])},async remove(t){let e=document.querySelector("#token").getAttribute("token");await fetch(`/delete/notification/?delete=1&notification_id=${t}&token=${e}`),this.notifications=this.notifications.filter(n=>n.ID!=t),this.notifications.length===0&&(this.open=!1)},async removeAll(){let t=document.querySelector("#token").getAttribute("token");await fetch(`/delete/notification/?delete=1&token=${t}`),this.notifications=[],this.open=!1}}}function h(){document.querySelectorAll(".js-unlimited-toggle").forEach(t=>{let e=t.parentElement.querySelector("input");Alpine.store("globals").isUnlimitedValue(e.value)?x(e,t):w(e,t),t.addEventListener("click",()=>{U(e,t)})})}function x(t,e){e.classList.add("active"),t.dataset.prevValue=t.value,t.value=Alpine.store("globals").UNLIM_TRANSLATED_VALUE,t.disabled=!0}function w(t,e){e.classList.remove("active");let n=t.dataset.prevValue?.trim();n&&(t.value=n),Alpine.store("globals").isUnlimitedValue(t.value)&&(t.value="0"),t.disabled=!1}function U(t,e){e.classList.contains("active")?w(t,e):x(t,e)}var C=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");function f(t=16){return C(t)+Math.floor(Math.random()*10)}function l({title:t,message:e="Are you sure?",targetUrl:n}){let i=document.createElement("dialog");if(i.classList.add("modal"),t){let m=document.createElement("h2");m.textContent=t,m.classList.add("modal-title"),i.append(m)}let r=document.createElement("p");r.textContent=e,r.classList.add("modal-message"),i.append(r);let o=document.createElement("div");o.classList.add("modal-options");let a=document.createElement("button");a.type="submit",a.classList.add("button"),a.textContent="OK",o.append(a);let s=document.createElement("button");s.type="button",s.classList.add("button","button-secondary","u-ml5"),s.textContent="Cancel",n&&o.append(s),i.append(o);let c=()=>{n&&(window.location.href=n),u()},d=()=>u(),u=()=>{a.removeEventListener("click",c),s.removeEventListener("click",d),i.removeEventListener("close",u),i.remove()};a.addEventListener("click",c),s.addEventListener("click",d),i.addEventListener("close",u),document.body.append(i),i.showModal()}function N(t,e){let n=document.querySelector(t),i=document.querySelector(e);if(!n||!i)return;function r(o){i.textContent=o,VE.helpers.generateMailCredentials()}n.addEventListener("input",o=>{r(o.target.value)}),r(n.value)}function p(){let t=document.querySelector(".js-mail-info");if(!t)return;let e=T(t.cloneNode(!0));document.querySelector(".js-hidden-credentials").value=e}function T(t){let e=[...t.querySelectorAll("h2")],n=[...t.querySelectorAll("ul")];return e.map((i,r)=>{let a=[...n[r].querySelectorAll("li")].map(s=>{let c=s.querySelector(".values-list-label"),d=s.querySelector(".values-list-value"),u=d.querySelector("a"),m=u?u.href:d.textContent;return`${c.textContent}: ${m}`}).join(`
`);return`${i.textContent}
${a}
`}).join(`
`)}function v(){Alpine.store("shortcuts",{registeredShortcuts:[],register(t,e,n){n={...{type:"keydown",propagate:!1,disabledInInput:!1,target:document},...n};let r=o=>{if(n.disabledInInput){let c=o.target.nodeType===3?o.target.parentNode:o.target;if(["input","textarea","selectbox"].includes(c.tagName.toLowerCase()))return}let a=[t.code?t.code==o.code:t.key.toLowerCase()==o.key.toLowerCase(),t.altKey&&o.altKey||!t.altKey&&!o.altKey,t.ctrlKey&&o.ctrlKey||!t.ctrlKey&&!o.ctrlKey,t.metaKey&&o.metaKey||!t.metaKey&&!o.metaKey,t.shiftKey&&o.shiftKey||!t.shiftKey&&!o.shiftKey];a.filter(c=>c).length===a.length&&(e(o),n.propagate||(o.stopPropagation(),o.preventDefault()))};return this.registeredShortcuts.push({combination:t,callback:r,target:n.target,event:n.type}),n.target.addEventListener(n.type,r),this},unregister(t){let e=this.registeredShortcuts.find(n=>JSON.stringify(n.combination)==JSON.stringify(t));if(e)return this.registeredShortcuts=this.registeredShortcuts.filter(n=>JSON.stringify(n.combination)!=JSON.stringify(t)),e.target.removeEventListener(e.event,e.callback,!1),this}}),Alpine.store("shortcuts").register({key:"A"},t=>{let e=document.querySelector("a.js-button-create");e&&(location.href=e.href)},{disabledInInput:!0}).register({key:"A",ctrlKey:!0,shiftKey:!0},t=>{let e=document.querySelector(".l-unit .ch-toggle:eq(0)").checked;document.querySelectorAll(".l-unit").forEach(n=>n.classList.toggle("selected"),!e),document.querySelectorAll(".l-unit .ch-toggle").forEach(n=>n.checked=!e)},{disabledInInput:!0}).register({code:"Enter",ctrlKey:!0},t=>{document.querySelector("form#vstobjects").submit()}).register({code:"Backspace",ctrlKey:!0},t=>{let e=document.querySelector("a.js-button-back").href;e&&(Alpine.store("form").dirty&&e?l({message:Alpine.store("globals").CONFIRM_LEAVE_PAGE,targetUrl:e}):e&&(location.href=e))}).register({key:"F"},t=>{let e=document.querySelector(".js-search-input");e&&e.focus()},{disabledInInput:!0}).register({code:"Digit1"},t=>{let e=document.querySelector(".main-menu .main-menu-item:nth-of-type(1) a");e&&(Alpine.store("form").dirty?l({message:Alpine.store("globals").CONFIRM_LEAVE_PAGE,targetUrl:e.href}):location.href=e.href)},{disabledInInput:!0}).register({code:"Digit2"},t=>{let e=document.querySelector(".main-menu .main-menu-item:nth-of-type(2) a");e&&(Alpine.store("form").dirty?l({message:Alpine.store("globals").CONFIRM_LEAVE_PAGE,targetUrl:e.href}):location.href=e.href)},{disabledInInput:!0}).register({code:"Digit3"},t=>{let e=document.querySelector(".main-menu .main-menu-item:nth-of-type(3) a");e&&(Alpine.store("form").dirty?l({message:Alpine.store("globals").CONFIRM_LEAVE_PAGE,targetUrl:e.href}):location.href=e.href)},{disabledInInput:!0}).register({code:"Digit4"},t=>{let e=document.querySelector(".main-menu .main-menu-item:nth-of-type(4) a");e&&(Alpine.store("form").dirty?l({message:Alpine.store("globals").CONFIRM_LEAVE_PAGE,targetUrl:e.href}):location.href=e.href)},{disabledInInput:!0}).register({code:"Digit5"},t=>{let e=document.querySelector(".main-menu .main-menu-item:nth-of-type(5) a");e&&(Alpine.store("form").dirty?l({message:Alpine.store("globals").CONFIRM_LEAVE_PAGE,targetUrl:e.href}):location.href=e.href)},{disabledInInput:!0}).register({code:"Digit6"},t=>{let e=document.querySelector(".main-menu .main-menu-item:nth-of-type(6) a");e&&(Alpine.store("form").dirty?l({message:Alpine.store("globals").CONFIRM_LEAVE_PAGE,targetUrl:e.href}):location.href=e.href)},{disabledInInput:!0}).register({code:"Digit7"},t=>{let e=document.querySelector(".main-menu .main-menu-item:nth-of-type(7) a");e&&(Alpine.store("form").dirty?l({message:Alpine.store("globals").CONFIRM_LEAVE_PAGE,targetUrl:e.href}):location.href=e.href)},{disabledInInput:!0}).register({key:"H"},t=>{let e=document.querySelector(".shortcuts");e.open?e.close():e.showModal()},{disabledInInput:!0}).register({code:"Escape"},t=>{let e=document.querySelector("dialog[open]");e&&e.close(),document.querySelectorAll("input, checkbox, textarea, select").forEach(n=>n.blur())}).register({code:"ArrowLeft"},t=>{VE.navigation.moveFocusLeft()},{disabledInInput:!0}).register({code:"ArrowRight"},t=>{VE.navigation.moveFocusRight()},{disabledInInput:!0}).register({code:"ArrowDown"},t=>{VE.navigation.moveFocusDown()},{disabledInInput:!0}).register({code:"ArrowUp"},t=>{VE.navigation.moveFocusUp()},{disabledInInput:!0}).register({key:"L"},t=>{let e=$(".units.active .l-unit.focus .shortcut-l");e.length&&VE.navigation.shortcut(e)},{disabledInInput:!0}).register({key:"S"},t=>{let e=$(".units.active .l-unit.focus .shortcut-s");e.length&&VE.navigation.shortcut(e)},{disabledInInput:!0}).register({key:"W"},t=>{let e=$(".units.active .l-unit.focus .shortcut-w");e.length&&VE.navigation.shortcut(e)},{disabledInInput:!0}).register({key:"D"},t=>{let e=$(".units.active .l-unit.focus .shortcut-d");e.length&&VE.navigation.shortcut(e)},{disabledInInput:!0}).register({key:"R"},t=>{let e=$(".units.active .l-unit.focus .shortcut-r");e.length&&VE.navigation.shortcut(e)},{disabledInInput:!0}).register({key:"N"},t=>{let e=$(".units.active .l-unit.focus .shortcut-n");e.length&&VE.navigation.shortcut(e)},{disabledInInput:!0}).register({key:"U"},t=>{let e=$(".units.active .l-unit.focus .shortcut-u");e.length&&VE.navigation.shortcut(e)},{disabledInInput:!0}).register({code:"Delete"},t=>{let e=$(".units.active .l-unit.focus .shortcut-delete");e.length&&VE.navigation.shortcut(e)},{disabledInInput:!0}).register({code:"Enter"},t=>{if(t.target.tagName=="INPUT"&&t.target.form.id=="vstobjects"&&document.querySelector("form#vstobjects").submit(),Alpine.store("form").dirty)document.querySelector("dialog[open]")?document.querySelector("dialog[open]").querySelector('button[type="submit"]').click():l({message:Alpine.store("globals").CONFIRM_LEAVE_PAGE,targetUrl:document.querySelector(`${VE.navigation.state.menu_selector}.focus a`).href});else if(document.querySelector("dialog[open]"))document.querySelector("dialog[open]").querySelector('button[type="submit"]').click();else{let e=$(".units.active .l-unit.focus .shortcut-enter");e.length?VE.navigation.shortcut(e):VE.navigation.enterFocused()}},{propagate:!0})}function y(){Alpine.bind("BulkEdit",()=>({"@submit"(t){t.preventDefault(),document.querySelectorAll(".ch-toggle").forEach(e=>{if(e.checked){let n=document.createElement("input");n.type="hidden",n.name=e.name,n.value=e.value,t.target.appendChild(n)}}),t.target.submit()}})),Alpine.store("form",{dirty:!1,makeDirty(){this.dirty=!0}}),document.querySelectorAll("#vstobjects input, #vstobjects select, #vstobjects textarea").forEach(t=>{t.addEventListener("change",()=>{Alpine.store("form").makeDirty()})}),Alpine.data("notifications",g),F()}function F(){h(),v()}function E(){if(document.querySelectorAll("dialog[open]").length===0){let e=document.querySelector("#vstobjects .form-control:not([disabled]),		#vstobjects .form-select:not([disabled])");e&&e.focus()}}function _(){document.querySelectorAll(".js-confirm-action").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();let n=t.dataset.confirmTitle,i=t.dataset.confirmMessage,r=t.getAttribute("href");l({title:n,message:i,targetUrl:r})})})}function b(){let t=document.querySelector(".js-toggle-all");t&&t.addEventListener("change",K)}function K(t){let e=t.target.checked;document.querySelectorAll(".ch-toggle").forEach(n=>{n.checked=e}),document.querySelectorAll(".l-unit").forEach(n=>{n.classList.toggle("selected",e)})}function A(){document.querySelectorAll(".toolbar-sorting-toggle").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),document.querySelector(".toolbar-sorting-menu").classList.toggle("u-hidden")})}),document.querySelectorAll(".toolbar-sorting-menu span").forEach(t=>{t.addEventListener("click",function(){if(document.querySelector(".toolbar-sorting-menu").classList.toggle("u-hidden"),this.classList.contains("active"))return;document.querySelectorAll(".toolbar-sorting-menu span").forEach(s=>s.classList.remove("active")),this.classList.add("active");let n=this.closest("li");VE.tmp.sort_par=n.getAttribute("entity"),VE.tmp.sort_as_int=!!n.getAttribute("sort_as_int"),VE.tmp.sort_direction=this.classList.contains("up")?1:-1;let i=document.querySelector(".toolbar-sorting-toggle");i.querySelector("b").innerHTML=n.querySelector(".name").innerHTML;let r=i.querySelector(".fas");r.classList.remove("fa-arrow-up-a-z","fa-arrow-down-a-z"),r.classList.add(this.classList.contains("up")?"fa-arrow-up-a-z":"fa-arrow-down-a-z");let o=Array.from(document.querySelectorAll(".units .l-unit")).sort((s,c)=>{let d=s.getAttribute(VE.tmp.sort_par),u=c.getAttribute(VE.tmp.sort_par);if(VE.tmp.sort_as_int){let m=parseInt(d),M=parseInt(u);return m>=M?VE.tmp.sort_direction:VE.tmp.sort_direction*-1}else return d<=u?VE.tmp.sort_direction:VE.tmp.sort_direction*-1}),a=document.querySelector(".units");o.forEach(s=>a.appendChild(s))})})}function S(){document.querySelector("#vstobjects")?.addEventListener("submit",j),document.querySelector('[x-bind="BulkEdit"]')?.addEventListener("submit",j)}function j(){document.querySelector(".js-fullscreen-loader").classList.add("active")}function I(){let t=document.querySelector(".js-add-ns");t&&t.addEventListener("click",()=>{let e=document.querySelectorAll("input[name^=v_ns]"),n=e.length;if(n<8){let i=e[0].parentElement.cloneNode(!0),r=i.querySelector("input");r.removeAttribute("value"),r.name=`v_ns${n+1}`,t.before(i)}n===7&&t.classList.add("u-hidden")}),document.querySelectorAll(".js-remove-ns").forEach(e=>{e.addEventListener("click",()=>{e.parentElement.remove(),document.querySelectorAll("input[name^=v_ns]").forEach((i,r)=>i.name=`v_ns${r+1}`),document.querySelector(".js-add-ns").classList.remove("u-hidden")})})}function L(){document.querySelectorAll(".js-password-input").forEach(t=>{let e=n=>{clearTimeout(window.frp_usr_tmt),window.frp_usr_tmt=setTimeout(()=>{D(n.target)},100)};t.addEventListener("keypress",e),t.addEventListener("input",e)}),document.querySelectorAll(".js-generate-password").forEach(t=>{t.addEventListener("click",()=>{let e=t.parentNode.nextElementSibling.querySelector(".js-password-input");e&&(e.value=f(),e.dispatchEvent(new Event("input")),D(e),p())})})}function D(t){let e=t.value,n=t.parentNode.querySelector(".js-password-meter");if(n){let r=[e.length>=8,e.search(/[a-z]/)>-1,e.search(/[A-Z]/)>-1,e.search(/\d/)>-1||e.search(/[^\dA-Za-z]/)>-1].reduce((o,a)=>o+a,0);n.value=r}}function q(){let t=document.querySelector(".toolbar"),e=document.querySelector(".top-bar");if(!t||!e)return;window.addEventListener("scroll",n);function n(){let i=t.getBoundingClientRect().top,r=window.scrollY,o=document.documentElement.clientTop,a=i+r-o,s=e.offsetHeight,c=r>a-s;t.classList.toggle("active",c)}}function V(){_(),b(),A(),S(),I(),L(),q()}function k(){return{state:{active_menu:1,menu_selector:".main-menu-item",menu_active_selector:".active"},enterFocused:()=>{$(".units").hasClass("active")?location.href=$(".units.active .l-unit.focus .actions-panel__col.actions-panel__edit a").attr("href"):$(VE.navigation.state.menu_selector+".focus a").attr("href")&&(location.href=$(VE.navigation.state.menu_selector+".focus a").attr("href"))},moveFocusLeft:()=>{let t=Number.parseInt($(VE.navigation.state.menu_selector).index($(VE.navigation.state.menu_selector+".focus")));t==-1&&(t=Number.parseInt($(VE.navigation.state.menu_selector).index($(VE.navigation.state.menu_active_selector)))),$(".units").hasClass("active")&&($(".units").removeClass("active"),t++),$(VE.navigation.state.menu_selector).removeClass("focus"),t>0?$($(VE.navigation.state.menu_selector)[t-1]).addClass("focus"):VE.navigation.switchMenu("last")},moveFocusRight:()=>{let t=$(VE.navigation.state.menu_selector).length-1,e=Number.parseInt($(VE.navigation.state.menu_selector).index($(VE.navigation.state.menu_selector+".focus")));e==-1&&(e=Number.parseInt($(VE.navigation.state.menu_selector).index($(VE.navigation.state.menu_active_selector)))||0),$(VE.navigation.state.menu_selector).removeClass("focus"),$(".units").hasClass("active")&&($(".units").removeClass("active"),e--),e<t?$($(VE.navigation.state.menu_selector)[e+1]).addClass("focus"):VE.navigation.switchMenu("first")},moveFocusDown:()=>{let t=$(".units .l-unit:not(.header)").length-1,e=Number.parseInt($(".units .l-unit").index($(".units .l-unit.focus")));e<t&&($(".units .l-unit.focus").removeClass("focus"),$($(".units .l-unit:not(.header)")[e+1]).addClass("focus"),$("html, body").animate({scrollTop:$(".units .l-unit.focus").offset().top-200},200))},moveFocusUp:()=>{let t=Number.parseInt($(".units .l-unit:not(.header)").index($(".units .l-unit.focus")));t==-1&&(t=0),t>0&&($(".units .l-unit.focus").removeClass("focus"),$($(".units .l-unit:not(.header)")[t-1]).addClass("focus"),$("html, body").animate({scrollTop:$(".units .l-unit.focus").offset().top-200},200))},switchMenu:t=>{if(t=t||"first",VE.navigation.state.active_menu==0)if(VE.navigation.state.active_menu=1,VE.navigation.state.menu_selector=".main-menu-item",VE.navigation.state.menu_active_selector=".active",t=="first")$($(VE.navigation.state.menu_selector)[0]).addClass("focus");else{let e=$(VE.navigation.state.menu_selector).length-1;$($(VE.navigation.state.menu_selector)[e]).addClass("focus")}},shortcut:t=>{switch(t[0].dataset.keyAction){case"js":{t[0].querySelector(".data-controls").click();break}case"href":{location.href=t.find("a").attr("href");break}default:break}}}}function O(){window.VE={tmp:{sort_par:"sort-name",sort_direction:-1,sort_as_int:!1},navigation:k(),helpers:{createConfirmationDialog:l,randomPassword:f,generateMailCredentials:p,monitorAndUpdate:N}},V(),E()}O();document.addEventListener("alpine:init",()=>y());})();
//# sourceMappingURL=main.min.js.map
