#!/bin/bash
# info: delete system firewall
# options: NONE
#
# example: v-delete-sys-firewall
#
# This function disables firewall support for both IPv4 and IPv6

#----------------------------------------------------------#
#                Variables & Functions                     #
#----------------------------------------------------------#

source /etc/hestiacp/hestia.conf
source /usr/local/hestia/func/main.sh
source_conf "$HESTIA/conf/hestia.conf"

#----------------------------------------------------------#
#                    Verifications                         #
#----------------------------------------------------------#

if [ -z "$FIREWALL_SYSTEM" ]; then
	exit
fi

check_hestia_demo_mode

#----------------------------------------------------------#
#                       Action                             #
#----------------------------------------------------------#

# Updating FIREWALL_SYSTEM value
$BIN/v-change-sys-config-value "FIREWALL_SYSTEM" ""

# Stopping IPv4 firewall
$BIN/v-stop-firewall

# Stopping IPv6 firewall (si existe el bin)
[ -x "$BIN/v-stop-firewall-ipv6" ] && $BIN/v-stop-firewall-ipv6

#----------------------------------------------------------#
#                       Hestia                             #
#----------------------------------------------------------#

$BIN/v-log-action "system" "Warning" "Firewall" "System firewall (IPv4/IPv6) disabled."
log_event "$OK" "$ARGUMENTS"

exit
